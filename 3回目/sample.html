<!DOCTYPE html>
<html lang="ja">
    <head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>LINEé¢¨ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒª
 </title>
 <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
 <link rel="stylesheet" href="css/style.css">
 
</head>

<body>

 <div class="container">
    <div class="message-person">
        <input id="me" type="radio" value="me" name="person" checked="checked">
        <label for="me">P1</label>
        <input id="you" type="radio" value="you" name="person">
        <label for="you">P2</label>
    </div>

    <div class="message-area">
        <div class="message-area-text">
          <textarea id="text"></textarea>
        </div>
        <div class="message-area-button">
          <button id="send" class="disabled-button">Send</button>
        </div>
    </div>
    
    <div class="chat-area"></div>
    
    
   
  </div>
 
  <script type="text/javascript">
  $(function() {
    $('.message-area-text').on('keypress', (e) => {
      if (e.which === 13) {
        addChat()
        return false; // falseã—ãªã„ã¨ã€æœ¬æ¥ã®Enter(æ”¹è¡Œ)ãŒå®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã†
      }
    })
 
    // é€ä¿¡ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰
    $('#send').on('click', addChat)
 
    function addChat() {
      // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢å†…ã®æ–‡å­—ã‚’å–å¾—ã™ã‚‹
      const messageText = $('#text').val()
 
      // ãƒ†ã‚­ã‚¹ãƒˆãŒç©ºã®çŠ¶æ…‹ã§ã¯ä½•ã‚‚ã›ãšã«çµ‚ã‚ã‚‰ã›ã‚‹
      if (messageText === '') {
        return false;
      }
 
      // ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ã®è¦ç´ ã‚’å–å¾—
      const chatArea = $('.chat-area')
 
      // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹divè¦ç´ 
      const messageContainer = $('<div></div>').addClass('message-container')
 
      // è‡ªåˆ† or ç›¸æ‰‹ã©ã¡ã‚‰ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹äºˆå®šã‹ã‚’å–å¾—
      const messagePerson = $('input[name="person"]:checked').val()
 
      // è‡ªåˆ†ã®æ™‚ã¯è‡ªåˆ†ç”¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¯ãƒ©ã‚¹ã‚’ã¤ã‘ã‚‹
      if (messagePerson === 'me') {
        messageContainer.addClass('message-container-me')
      } else {
        // ç›¸æ‰‹ã®æ™‚ã¯ç›¸æ‰‹ç”¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¯ãƒ©ã‚¹ã‚’ã¤ã‘ã‚‹
        messageContainer.addClass('message-container-you')
      }
 
      // ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”¨ã®è£…é£¾ã‚’ã—ãŸã‚¯ãƒ©ã‚¹ã‚’å½“ã¦ãŸpã‚¿ã‚°ã‚’è¿½åŠ 
      const message = $('<p></p>').addClass('chat-message').text(messageText)
 
      // ç¾åœ¨æ™‚é–“ã®Dateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã™ã‚‹
      const nowDate = new Date()
      const hour    = (nowDate.getHours() >= 10) ? nowDate.getHours() : '0' + nowDate.getHours()
      const minutes    = (nowDate.getMinutes() >= 10) ? nowDate.getMinutes() : '0' + nowDate.getMinutes()
 
      // ç¾åœ¨æ™‚é–“
      const nowTime = hour + ':' + minutes
 
      // ç¾åœ¨æ™‚é–“ã‚’è¡¨ç¾ã™ã‚‹pã‚¿ã‚°ã‚’ç”¨æ„
      const sendTime = $('<p></p>').text(nowTime).addClass('chat-time')
 
      // divã®ä¸­ã«ã€é€ä¿¡æ™‚é–“ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã™ã‚‹
      messageContainer.append(sendTime).append(message)
 
      chatArea.append(messageContainer)
 
      // å¸¸ã«æœ€ä¸‹éƒ¨ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ãŠã
      chatArea.scrollTop(chatArea[0].scrollHeight)
 
      // textã‚’ç©ºã«ã™ã‚‹
      $('#text').val('') // ç©ºæ–‡å­—ã‚’æŒ‡å®šã™ã‚Œã°ä¸Šæ›¸ãã•ã‚Œã‚‹
    }
  })


  
 
  </script>

<div class="resetbutton">
    <button type="button" onclick="window.location.reload();">Reset</button>

</div>
 
  <!--/ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->

  <!-- JQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <!-- JQuery -->

  <!--** ä»¥ä¸‹Firebase **-->
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <!-- 8.6.2ã«è©²å½“ã™ã‚‹ç®‡æ‰€ã¯firebaseã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ã®ã§æ›´æ–°ã•ã‚Œã‚‹ãŸã³ã«éšæ™‚å¤‰ã‚ã‚Šã¾ã™ğŸ¤— -->
  <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#config-web-app -->

  <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "AIzaSyD1Xv8B-58NJJ09qnCDmJyAoO-XUTqSEZo",
      authDomain: "dev20chat-aa6be.firebaseapp.com",
      databaseURL: "https://dev20chat-aa6be-default-rtdb.firebaseio.com/",
      projectId: "dev20chat-aa6be",
      storageBucket: "dev20chat-aa6be.appspot.com",
      messagingSenderId: "353554247507",
      appId: "1:353554247507:web:69ce6a644c2159cdabfba6"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    //firebaseã®ãƒ‡ãƒ¼ã‚¿ãƒ¼ãƒ™ãƒ¼ã‚¹ï¼ˆä¿å­˜ã•ã›ã‚‹å ´æ‰€ï¼‰ã‚’ä½¿ã„ã¾ã™ã‚ˆ
    const newPostRef = firebase.database().ref();

    // ã“ã“ã‹ã‚‰ä¸‹ã«jqueryã®å‡¦ç†ã‚’æ›¸ã„ã¦ç·´ç¿’ã—ã¾ã™

    // é€ä¿¡ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚‰æ¬¡ã®å‡¦ç†ã‚’ã™ã‚‹
   // $("#send").on("click", function () {

     // let username = $("#username").val();
      //if (username === ""){
        //alert("å…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“")ã€€//ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½     }


      //è¨˜è¿°ï¼‘
      //ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ã§é€ã‚‹
//      newPostRef.push({
        //username:$("#username").val(),//åå‰
        //text: $("#text").val()//ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢      })
//      $("#username").val("")ã€€//ç©ºã«ã™ã‚‹
  //    $("#text").val("")ã€€//ç©ºã«ã™ã‚‹

    //});

    // å—ä¿¡å‡¦ç†
    //newPostRef.on("child_added", function (data) {
      //let v = data.val();ã€€// ã“ã“ã«ä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒå…¨ã¦å…¥ã£ã¦ãã‚‹
      //let k = data.key;ã€€// ä»Šå›ã¯ä½¿ã„ã¾ã›ã‚“

      // console.logã§Firebaseã§å—ä¿¡ã§ãã¦ã„ã‚‹ã‹ç¢ºèª(ãƒ‡ãƒ¼ã‚¿ã®å¡Šã®ã‚¢ã‚¯ã‚»ã‚¹)
      //console.log(v)

      // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«``ã‚’æ´»ç”¨ã—ã¦å¤‰æ•°ã«htmlã‚’åŸ‹ã‚è¾¼ã‚‚ã†


      //let str = `<p>${v.username}<br>${v.text}<p>`;
      
      //ã“ã“ã«ãƒ‡ãƒ¼ã‚¿ã‚’htmlã«åŸ‹ã‚è¾¼ã‚€ã€€prependã«ã¯å¤‰æ•°ã‚’åŸ‹ã‚è¾¼ã‚‚ã†
      //$("#output").prepend(str);

    //})

    
    //eventã®e

    //$("#text").on("keydown", function (e) {
      
      //console.log(e, 'eventãƒ‡ãƒ¼ã‚¿ã®å¡Š');

      //if(e.keyCode === 13) {
        //newPostRef.push({
          //username:$("#username").val(),//åå‰
          //text: $("#text").val()//ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢       }        )
      //$("#username").val("")ã€€//ç©ºã«ã™ã‚‹
      //$("#text").val("")ã€€//ç©ºã«ã™ã‚‹
      //}

    //});
        
    
    



  </script>
</body>

</html>